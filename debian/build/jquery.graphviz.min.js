(function(a){a.fn.graphviz=function(n){var f="->";var j={status:"movable",statusbar:true,dragableCursor:"move"};n=a.extend(j,n||{});function u(x){return a(x).children("title").text()}function g(x){var y=a("g.node title").filter(function(z){return this.textContent.trim()===x});return y.parent()}function o(x,z){if(z&&z==="input"){x=x+f}else{if(z&&z==="output"){x=f+x}}var y=a("g.edge title").filter(function(A){return this.textContent.indexOf(x)!==-1});return y.parent()}function t(x,y){var A=x+f+y;var z=a("g.edge title").filter(function(B){return this.textContent.indexOf(A)!==-1});return z.parent()}function c(z,y,x){z.x.baseVal.getItem(0).value=z.x.baseVal.getItem(0).value+y;z.y.baseVal.getItem(0).value=z.y.baseVal.getItem(0).value+x}function m(B,y,x){var z=g(B);var A=a(z.children());var D=A.filter("text")[0];if(D){c(D,y,x)}var C=A.filter("ellipse")[0];C.cx.baseVal.value=C.cx.baseVal.value+y;C.cy.baseVal.value=C.cy.baseVal.value+x}function l(A,y,x,C){var E=A.pathSegList;var z=0;var F=E.numberOfItems-1;var B,D;for(B=z;B<=F;B=B+1){D=E.getItem(B);if(!(B===0&&(C==="output"||C===undefined))&&!(B===F&&(C==="input"||C===undefined))){D.x=D.x+y;D.y=D.y+x}if(D.pathSegTypeAsLetter==="C"){D.x1=D.x1+y;D.y1=D.y1+x;D.x2=D.x2+y;D.y2=D.y2+x}}A.setAttribute("d",A.getAttribute("d"))}function s(x){var y=false;var B=0;var A=1;var D,z;var C=x.points;while(!y&&B<C.numberOfItems-1){while(!y&&A<C.numberOfItems){D=C.getItem(B);z=C.getItem(A);if(D.x===z.x&&D.y===z.y){y=D}B=B+1}}return y}function d(E,z,y,x,C){var A;var B=s(E);var F=z.pathSegList;if(C==="output"){for(A=0;A<E.points.numberOfItems;A=A+1){var D=E.points.getItem(A);D.x=D.x+y;D.y=D.y+x}}}function e(x,A,z,C){var y=a(x).children();var F=y.filter("path")[0];var B;l(F,A,z,C);var D=y.filter("polygon")[0];if(D){d(D,F,A,z,C)}var E=y.filter("text")[0];if(E){c(E,A,z)}}function k(A,y,x){var z=o(A,"input");var B=o(A,"output");z.each(function(C,D){e(D,y,x,"input")});B.each(function(C,D){e(D,y,x,"output")})}function q(z,y,x){m(z,y,x);k(z,y,x)}function r(x){a(x).remove()}function h(x){a(x).remove()}function v(y){var z=u(y);var x=o(z);x.each(function(){h(this)});r(y)}function b(y,E){var D=a(y).children("text");var B="";var C,x,A,z;if(D.length){D=D[0];B=D.textContent.trim()}else{D=a("text")[0].cloneNode();D.textContent="";if(y.className.baseVal==="edge"){C=a(y).children("path")[0];A=C.pathSegList.getItem(C.pathSegList.numberOfItems/2);a(D).attr("x",A.x);a(D).attr("y",A.y)}else{x=a(y).children("ellipse")[0];a(D).attr("x",x.cx.baseVal.value);a(D).attr("y",x.cy.baseVal.value+x.ry.baseVal.value/3)}a(D).appendTo(y);B=""}z=prompt(E,B);if(z!==null){D.textContent=z}}function i(x){var E="jqueryGraphVizToolBar";var A='<ul class="'+E+'" >';var C="editText";var B="addNode";var z='<li><a href="#editTexts" class="'+C+'"> Edit Texts </a></li>';var y='<li><a href="#add" class="'+B+'"> Add Node </a></li>';var D="</ul>";a(A+z+y+D).insertBefore(x);a("."+E+" li a."+C).click(w(function(){var I=!a(this.node).hasClass("selected");var G,F;if(I){F="movable";G="editable";a(this.node).parent().addClass("selected");a(this.node).addClass("selected")}else{F="editable";G="movable";a(this.node).parent().removeClass("selected");a(this.node).removeClass("selected")}n.status=G;var J=a(this.svg).children("g.graph");var H=J.attr("class");J.attr("class",H.replace(F,G));return false},{svg:x,link:this}));a("."+E+" li a."+B).click(w(function(){var F=a("g.node")[0].cloneNode();var G=a(this.svg).children("g.graph");a(F).appendTo(G);return false},{svg:x,link:this}))}function w(y,x){return function(){x.node=arguments["0"].target;return y.apply(x,arguments)}}function p(){if(n.status==="movable"){return n.dragableCursor}}this.each(function(){var x;if(n.statusbar){i(this)}x=a(this).children().filter("g.graph").attr("class");a(this).children().filter("g.graph").attr("class",x+" "+n.status);a(this).children().children("g").each(function(){if(this.className.baseVal==="node"){a(this).draggable({start:function(y,z){if(n.status==="movable"){this.originalX=y.clientX;this.originalY=y.clientY}},stop:function(y,z){if(n.status==="movable"){q(a(this.childNodes).filter("title")[0].textContent.trim(),(y.clientX-this.originalX),(y.clientY-this.originalY))}},drag:function(y,z){if(n.status==="movable"){q(a(this.childNodes).filter("title")[0].textContent.trim(),(y.clientX-this.originalX),(y.clientY-this.originalY));this.originalX=y.clientX;this.originalY=y.clientY}},cursor:p});a(this).dblclick(function(){if(n.status==="movable"){v(this)}else{if(n.status==="editable"){b(this,"Do you want to change the text of the node?")}}})}else{if(this.className.baseVal==="edge"){a(this).draggable({start:function(z,A){if(n.status==="movable"){var B=a(this).children("path")[0];var D=B.getTotalLength();var C=B.pathSegList.getItem(0);var y=B.getPointAtLength(0).matrixTransform(B.getScreenCTM());if(Math.abs(y.x-z.clientX)+Math.abs(y.y-z.clientY)<D/10){this.io="input"}else{this.io=undefined}this.originalX=z.clientX;this.originalY=z.clientY}},stop:function(y,z){if(n.status==="movable"){e(this,(y.clientX-this.originalX),(y.clientY-this.originalY),this.io)}},drag:function(y,z){if(n.status==="movable"){e(this,(y.clientX-this.originalX),(y.clientY-this.originalY),this.io);this.originalX=y.clientX;this.originalY=y.clientY}},cursor:p});a(this).children("polygon").draggable({start:function(y,z){if(n.status==="movable"){this.originalX=y.clientX;this.originalY=y.clientY}},stop:function(y,z){if(n.status==="movable"){e(a(this).parent(),(y.clientX-this.originalX),(y.clientY-this.originalY),"output")}},drag:function(y,z){if(n.status==="movable"){e(a(this).parent(),(y.clientX-this.originalX),(y.clientY-this.originalY),"output");this.originalX=y.clientX;this.originalY=y.clientY}},cursor:p});a(this).dblclick(function(){if(n.status==="movable"){h(this)}else{if(n.status==="editable"){b(this,"Do you want to change the text of the edge?")}}})}}})})}})(jQuery);